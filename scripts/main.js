"use strict";var app={};app.loca={},app.filtered=[],app.destination={},app.selected={},app.selectedPlace={},app.selectedImage={},app.foodType={},app.baseURL="restaurant_roulette/";var map=void 0;app.displayDatabase=function(e){var t=void 0;t="liked"==e?firebase.database().ref("users/"+app.userId.uid+"/"+e):firebase.database().ref("users/"+app.userId.uid+"/"+e).limitToLast(10),t.on("value",function(t){var a=t.val(),n=$.map(a,function(e,t){return e}).reverse();0==n.length?$("#"+e+"_content").append("<h2>You did't like anything yet</h2>"):("liked"==e?$("#"+e+"_content").append("<h1>You Liked</h1>"):$("#"+e+"_content").append("<h1>You Looked At</h1>"),n.forEach(function(t){$("#"+e+"_content").append(app.writeup(t.photo,t.name,t.url,t.phone))}))})},app.writeup=function(e,t,a,n){return'<div class="container">\n\t\t\t<img src="'+e+'">\n\t\t\t<div class="content">\n\t\t\t\t<h3 class="place_title">'+t+'</h3>\n\t\t\t\t\n\t\t\t\t<h4 class="website"><a href="'+a+'">'+a+'</a></h4>\n\t\t\n\t\t\t\t<h4 class="phone"><a href="tel:'+n+'">'+n+'</a></h4>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="divider content_divider"></div>'},app.place=function(e){app.destination={lat:e.lat,lng:e.lng};var t="";t=1==e.price?"$":(e.price=2)?"$$":"$$$",$("#section2 .place_title").text(e.name),$("#section2 #distance").text(e.distance+"m"),$("#section2 .rating").text(e.rating),$("#section2 #price").text(t),$("#section2 #website").html('<a href="'+e.url+'">'+e.url+"</a>"),$("#section2 #phone").html('<a href="tel:'+e.phone+'">'+e.phone+"</a>"),$("#tip h3").text(e.tips),$("#img_container").css("background-image","url('"+e.photo+"')"),app.mapArray(app.selected),firebase.database().ref("/users/"+firebase.auth().currentUser.uid+"/history").push(app.selectedPlace)},app.getImage=function(e){$.ajax({url:"https://api.foursquare.com/v2/venues/"+e.id+"/photos",method:"GET",dataType:"json",data:{client_id:"VH42GH0DFNZLHDRYB4JULCZIPHD3DA4DUCKVPVBMJQIX350R",client_secret:"DLDPDU4LK3ZAGTLHFQLC2JEDGNR01X1MCRRS1NF3VQPV22VL",v:20171120}}).then(function(e){app.selectedImage=""+e.response.photos.items[0].prefix+e.response.photos.items[0].width+"x"+e.response.photos.items[0].height+e.response.photos.items[0].suffix}).then(function(){app.selectedPlace={id:app.selected.venue.id,name:app.selected.venue.name,distance:app.selected.venue.location.distance,rating:app.selected.venue.rating,price:app.selected.venue.price.tier,url:app.selected.venue.url,phone:app.selected.venue.contact.phone,photo:app.selectedImage,lat:app.selected.venue.location.lat,lng:app.selected.venue.location.lng,tips:app.selected.tips[0].text},app.place(app.selectedPlace)})},app.pickRandom=function(e){var t=Math.floor(Math.random()*app.filtered.length);app.filtered.length>0?(app.selected=app.filtered[t],app.getImage(app.selected.venue)):TweenMax.to($(".warning"),1,{opacity:"1",display:"block"})},app.filterResult=function(e){app.filtered=e.filter(function(e){return e.venue.rating>8.5})},app.mapArray=function(e){console.log(e);var t=app.filtered.indexOf(e);app.filtered.splice(t,1)},app.fourSquare=function(e,t){app.clientId="VH42GH0DFNZLHDRYB4JULCZIPHD3DA4DUCKVPVBMJQIX350R",app.clientSecret="DLDPDU4LK3ZAGTLHFQLC2JEDGNR01X1MCRRS1NF3VQPV22VL",$.ajax({url:"https://api.foursquare.com/v2/venues/explore",method:"GET",dataType:"json",data:{client_id:"VH42GH0DFNZLHDRYB4JULCZIPHD3DA4DUCKVPVBMJQIX350R",client_secret:"DLDPDU4LK3ZAGTLHFQLC2JEDGNR01X1MCRRS1NF3VQPV22VL",ll:e.lat+","+e.long,radius:2500,query:""+t,openNow:1,v:20171120}}).then(function(e){app.filterResult(e.response.groups[0].items)}).then(function(){app.pickRandom(app.filtered),$("#section2").fadeToggle(),$("#section1").fadeToggle(),TweenMax.to($("#section2"),1,{opacity:1,ease:Back.easeOut}).delay(1)})},app.googleMaps=function(e,t){function a(e,t,a,n){for(var i=e.routes[0].legs[0],o=0;o<i.steps.length;o++){(t[o]=t[o]||new google.maps.Marker).setMap(n)}}app.googleKey="AIzaSyB6UumqnkB2X99K9Eeef_RzAQSENqA3I0k";var n=[],i=new google.maps.LatLng(e.lat,e.long),o=new google.maps.LatLng(t.lat,t.lng),p=$("#map")[0],s={center:{lat:e.lat,lng:e.long},zoom:20},c=new google.maps.DirectionsService;map=new google.maps.Map(p,s);var l=new google.maps.DirectionsRenderer({map:map}),r=new google.maps.InfoWindow;!function(e,t,n,p,s){for(var c=0;c<n.length;c++)n[c].setMap(null);t.route({origin:i,destination:o,travelMode:"WALKING"},function(t,i){"OK"===i?(e.setDirections(t),a(t,n,p,s)):window.alert("Directions request failed due to "+i)})}(l,c,n,r,map)},app.location=function(){return new Promise(function(e,t){navigator.geolocation.getCurrentPosition(function(t){e(t),app.loca={lat:t.coords.latitude,long:t.coords.longitude}})})},app.dataBase=function(){var e={apiKey:"AIzaSyCsA8GKOpORb7xuyhUNH7JhDtFWzJ6IYWg",authDomain:"project3-f7eba.firebaseapp.com",databaseURL:"https://project3-f7eba.firebaseio.com",projectId:"project3-f7eba",storageBucket:"project3-f7eba.appspot.com",messagingSenderId:"925278152263"};firebase.initializeApp(e);firebase.database();firebase.auth().onAuthStateChanged(function(e){e&&(app.userId=firebase.auth().currentUser)})},app.Log=function(e){if("facebook"==e)var t=new firebase.auth.FacebookAuthProvider;else if("google"==e)var t=new firebase.auth.GoogleAuthProvider;else if("github"==e)var t=new firebase.auth.GithubAuthProvider;firebase.auth().onAuthStateChanged(function(e){e?e&&"/"==window.location.pathname?window.location="/"+app.baseURL+"app.html":e||window.location.pathname!="/"+app.baseURL+"app.html"||(window.location="/"):firebase.auth().signInWithPopup(t).then(function(e){e.credential.accessToken;app.userId=e.user}).catch(function(e){console.log(e);e.code,e.message,e.email,e.credential})})},app.eventFire=function(){var e=$("#section3 .btnblue"),t=$("#direction"),a=$("#section2 .btnwhite:first-child"),n=$("#section2 .btnwhite:last-child"),i=$("#like"),o=$(".foodbtn"),p=$("#log_in"),s=$("#header div"),c=$("#loginSection > div");i.on("click",function(){$(this).addClass("animation"),firebase.database().ref("/users/"+firebase.auth().currentUser.uid+"/liked").push(app.selectedPlace),setTimeout(function(){i.removeClass("animation")},2e3)}),e.on("click",function(){$("#section2").fadeToggle(),$("#section3").fadeToggle(),$("#map").remove(),map=null}),t.on("click",function(){$("#section3").prepend('<div id="map"></div>'),app.googleMaps(app.loca,app.destination),$("#section3").fadeToggle(),$("#section2").fadeToggle()}),a.on("click",function(){$("#section1").fadeToggle(),$("#section2").fadeToggle()}),n.on("click",function(){new Promise(function(e){$("#section2").fadeOut(),e()}).then(function(){app.pickRandom(app.filtered)}).then(function(){$("#section2").css("opacity",0),$("#section2").fadeIn()})}),o.on("click",function(){app.foodType=$(this).data("type"),TweenMax.to($(".preloader"),1,{display:"flex",opacity:"1"}),app.location().then(function(){}).then(function(e){app.fourSquare(app.loca,app.foodType),TweenMax.to($(".preloader"),1,{opacity:"0",display:"none"})})}),p.on("click",function(){"/"!=window.location.pathname&&firebase.auth().signOut().then(function(){window.location="/"}).catch(function(e){console.log(e)})}),c.on("click",function(){var e=$(this).data("log");app.Log(e),console.log(window.location)}),s.on("click",function(){$(this).hasClass("active")?(s.removeClass("active"),$(this).empty(),$(this).is("#liked")?$("#liked").append('<i class="fas fa-thumbs-up"></i>'):$(this).is("#history")&&$("#history").append('<i class="fas fa-history"></i>'),$("#external_info").removeClass("active"),TweenMax.to($("#external_info"),1,{opacity:"0",display:"none"})):(s.removeClass("active"),$("#external_info").removeClass("active"),TweenMax.to($("#external_info"),1,{opacity:"0",display:"none"}),$("#liked_content").empty(),$("#history_content").empty(),$(this).addClass("active"),$(this).empty(),$(this).append('<i class="fas fa-times-circle"></i>'),$(this).is("#liked")?($("#external_info").addClass("active"),TweenMax.to($("#external_info"),1,{display:"block",opacity:"1"}),$("#history").empty(),$("#history").append('<i class="fas fa-history"></i>'),app.displayDatabase("liked")):$(this).is("#history")&&($("#external_info").addClass("active"),TweenMax.to($("#external_info"),1,{display:"block",opacity:"1"}),$("#liked").empty(),$("#liked").append('<i class="fas fa-thumbs-up"></i>'),app.displayDatabase("history")))}),$(".warning .btnblue").on("click",function(){TweenMax.to($(".warning"),1,{opacity:"0",display:"none"})})},app.init=function(){app.dataBase(),TweenMax.to($(".foodbtn"),2,{opacity:1,ease:Back.easeOut})},$(function(){app.init(),app.eventFire()});
//# sourceMappingURL=main.js.map